<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Pedro J. Aphalo" />

<meta name="date" content="2018-02-27" />

<title>User Guide</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">User Guide</h1>
<h3 class="subtitle"><em>‘photobiologyWavebands’ 0.4.2.1.9000</em></h3>
<h4 class="author"><em>Pedro J. Aphalo</em></h4>
<h4 class="date"><em>2018-02-27</em></h4>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#waveband-constructors-for-ranges">Waveband constructors for ranges</a><ul>
<li><a href="#waveband-constructors-for-color-based-wavelength-ranges">Waveband constructors for color-based wavelength ranges</a></li>
<li><a href="#waveband-constructors-for-instrument-based-wavelength-ranges">Waveband constructors for instrument-based wavelength ranges</a></li>
</ul></li>
<li><a href="#calculating-irradiances">Calculating irradiances</a></li>
<li><a href="#photon-ratios">Photon ratios</a></li>
<li><a href="#spectral-weighting-functions-swfs">Spectral weighting functions (SWFs)</a><ul>
<li><a href="#waveband-constructors-for-bswfs">Waveband constructors for BSWFs</a></li>
<li><a href="#effective-irradiances-and-exposures">Effective irradiances and exposures</a></li>
<li><a href="#bswfs-function-definitions">BSWFs function definitions</a></li>
</ul></li>
<li><a href="#luminous-flux">Luminous flux</a></li>
</ul>
</div>

<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>This package provides constructors for <code>waveband</code> objects, a class defined in package ‘photobiology’. These are convenience functions that allow definition of ranges of wavelengths and biological spectral weighting functions (BSWFs) following definitions in common use, CIE recommendations and ISO standards.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(photobiology)
<span class="kw">library</span>(photobiologyWavebands)</code></pre></div>
</div>
<div id="waveband-constructors-for-ranges" class="section level2">
<h2>Waveband constructors for ranges</h2>
<p>Functions for several colour bands, in some cases according to different optional definitions, are listed in the tables below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Red</span>(<span class="st">&quot;ISO&quot;</span>)</code></pre></div>
<pre><code>## Red.ISO 
## low (nm) 610 
## high (nm) 760 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Red</span>(<span class="st">&quot;Smith10&quot;</span>)</code></pre></div>
<pre><code>## Red.Smith10 
## low (nm) 655 
## high (nm) 665 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">PAR</span>()</code></pre></div>
<pre><code>## PAR 
## low (nm) 400 
## high (nm) 700 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UV</span>()</code></pre></div>
<pre><code>## UV.ISO 
## low (nm) 100 
## high (nm) 400 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">IR</span>()</code></pre></div>
<pre><code>## IR.ISO 
## low (nm) 780 
## high (nm) 1e+06 
## weighted none</code></pre>
<div id="waveband-constructors-for-color-based-wavelength-ranges" class="section level3">
<h3>Waveband constructors for color-based wavelength ranges</h3>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ultraviolet</strong></td>
<td></td>
</tr>
<tr class="even">
<td>UV()</td>
<td>ISO</td>
</tr>
<tr class="odd">
<td>UVC()</td>
<td>ISO, medical, none</td>
</tr>
<tr class="even">
<td>UVB()</td>
<td>ISO, none</td>
</tr>
<tr class="odd">
<td>UVA()</td>
<td>ISO, CIE, none</td>
</tr>
<tr class="even">
<td>UVA1()</td>
<td>CIE</td>
</tr>
<tr class="odd">
<td>UVA2()</td>
<td>CIE</td>
</tr>
<tr class="even">
<td><strong>visible</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>VIS()</td>
<td>ISO</td>
</tr>
<tr class="even">
<td>PAR()</td>
<td></td>
</tr>
<tr class="odd">
<td>Purple()</td>
<td>ISO</td>
</tr>
<tr class="even">
<td>Blue()</td>
<td>ISO, Sellaro</td>
</tr>
<tr class="odd">
<td>Green()</td>
<td>ISO, Sellaro</td>
</tr>
<tr class="even">
<td>Yellow()</td>
<td>ISO</td>
</tr>
<tr class="odd">
<td>Orange()</td>
<td>ISO</td>
</tr>
<tr class="even">
<td>Red()</td>
<td>ISO, Smith10, Smith20, Inada, Warrington, Sellaro</td>
</tr>
<tr class="odd">
<td>Far_red()</td>
<td>Smith10, Smith20, Inada, Warrington, Sellaro, BTV</td>
</tr>
<tr class="even">
<td><strong>infrared</strong></td>
<td></td>
</tr>
<tr class="odd">
<td>IR()</td>
<td>ISO, CIE</td>
</tr>
<tr class="even">
<td>NIR()</td>
<td>ISO</td>
</tr>
<tr class="odd">
<td>MIR()</td>
<td>ISO</td>
</tr>
<tr class="even">
<td>FIR()</td>
<td>ISO</td>
</tr>
<tr class="odd">
<td>IRA()</td>
<td>CIE</td>
</tr>
<tr class="even">
<td>IRB()</td>
<td>CIE</td>
</tr>
<tr class="odd">
<td>IRC()</td>
<td>CIE</td>
</tr>
<tr class="even">
<td>SWIR()</td>
<td></td>
</tr>
</tbody>
</table>
<p>Constructors of lists of waveband definitions frequently used together are also defined in the package.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UV_bands</span>(<span class="st">&quot;ISO&quot;</span>)</code></pre></div>
<pre><code>## [[1]]
## UVC.ISO 
## low (nm) 100 
## high (nm) 280 
## weighted none 
## 
## [[2]]
## UVB.ISO 
## low (nm) 280 
## high (nm) 315 
## weighted none 
## 
## [[3]]
## UVA.ISO 
## low (nm) 315 
## high (nm) 400 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">UV_bands</span>(<span class="st">&quot;CIE&quot;</span>)</code></pre></div>
<pre><code>## [[1]]
## UVC.CIE 
## low (nm) 100 
## high (nm) 280 
## weighted none 
## 
## [[2]]
## UVB.CIE 
## low (nm) 280 
## high (nm) 315 
## weighted none 
## 
## [[3]]
## UVA1.CIE 
## low (nm) 315 
## high (nm) 340 
## weighted none 
## 
## [[4]]
## UVA2.CIE 
## low (nm) 340 
## high (nm) 400 
## weighted none</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Plant_bands</span>()</code></pre></div>
<pre><code>## [[1]]
## UVB.ISO 
## low (nm) 280 
## high (nm) 315 
## weighted none 
## 
## [[2]]
## UVA.ISO 
## low (nm) 315 
## high (nm) 400 
## weighted none 
## 
## [[3]]
## Blue.Sellaro 
## low (nm) 420 
## high (nm) 490 
## weighted none 
## 
## [[4]]
## Green.Sellaro 
## low (nm) 500 
## high (nm) 570 
## weighted none 
## 
## [[5]]
## Red.Smith20 
## low (nm) 650 
## high (nm) 670 
## weighted none 
## 
## [[6]]
## FarRed.Smith20 
## low (nm) 720 
## high (nm) 740 
## weighted none</code></pre>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>UV_bands()</td>
<td>ISO, CIE, medical, none</td>
</tr>
<tr class="even">
<td>VIS_bands()</td>
<td>ISO</td>
</tr>
<tr class="odd">
<td>IR_bands()</td>
<td>ISO, CIE</td>
</tr>
<tr class="even">
<td>Plants_bands()</td>
<td>sensory, sensory10, sensory20, ISO, CIE, none</td>
</tr>
</tbody>
</table>
</div>
<div id="waveband-constructors-for-instrument-based-wavelength-ranges" class="section level3">
<h3>Waveband constructors for instrument-based wavelength ranges</h3>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Remote sensing</strong></td>
<td></td>
</tr>
<tr class="even">
<td>VIS()</td>
<td>LandsatRBV, LandsatOLI, Landsat7, RS</td>
</tr>
<tr class="odd">
<td>Blue()</td>
<td>LandsatTM, LandsatETM, LandsatOLI</td>
</tr>
<tr class="even">
<td>Green()</td>
<td>LandsatTM, LandsatETM, LandsatOLI, LandsatMSS, LandsatRBV</td>
</tr>
<tr class="odd">
<td>Red()</td>
<td>LandsatTM, LandsatETM, LandsatOLI, LandsatMSS, LandsatRBV</td>
</tr>
<tr class="even">
<td>NIR()</td>
<td>LandsatTM, LandsatETM, LandsatOLI, LandsatMSS, LandsatRBV</td>
</tr>
<tr class="odd">
<td>SWIR1()</td>
<td>LandsatTM, LandsatETM, LandsatOLI</td>
</tr>
<tr class="even">
<td>SWIR2()</td>
<td>LandsatTM, LandsatETM, LandsatOLI</td>
</tr>
<tr class="odd">
<td>TIR1()</td>
<td>LandsatTIRS</td>
</tr>
<tr class="even">
<td>TIR2()</td>
<td>LandsatTM, LandsatETM, LandsatTIRS</td>
</tr>
</tbody>
</table>
<p>Additional constructors are provided for Landsat missions, for example the list of wavebands used in mission Landsat 1 can be created directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">Landsat_bands</span>(<span class="st">&quot;L1&quot;</span>)</code></pre></div>
<pre><code>## [[1]]
## Green.LandsatRBV 
## low (nm) 480 
## high (nm) 580 
## weighted none 
## 
## [[2]]
## Red.LandsatRBV 
## low (nm) 580 
## high (nm) 680 
## weighted none 
## 
## [[3]]
## NIR.LandsatRBV 
## low (nm) 700 
## high (nm) 830 
## weighted none 
## 
## [[4]]
## Green.LandsatMSS 
## low (nm) 500 
## high (nm) 600 
## weighted none 
## 
## [[5]]
## Red.LandsatMSS 
## low (nm) 600 
## high (nm) 700 
## weighted none 
## 
## [[6]]
## NIR.LandsatMSS 
## low (nm) 800 
## high (nm) 1100 
## weighted none</code></pre>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>std</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Landsat_bands()</td>
<td>L1, L2, L3, L4, L5, L6; L7, L8</td>
</tr>
<tr class="even">
<td>RBV_bands()</td>
<td>LandsatRBV, L1, L2</td>
</tr>
<tr class="odd">
<td>MSS_bands()</td>
<td>LandsatMSS, L1, L2, L3, L4, L5</td>
</tr>
<tr class="even">
<td>OLI_bands()</td>
<td>LandsatOLI, L8</td>
</tr>
<tr class="odd">
<td>TIRS_bands()</td>
<td>LandsatTIRS, L8</td>
</tr>
<tr class="even">
<td>ETM_bands()</td>
<td>LandsatETM, L4, L5</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="calculating-irradiances" class="section level2">
<h2>Calculating irradiances</h2>
<p>An example using <code>sun.pct</code> included in package ‘photobiology’. As the input spectral irradiance is units of Watt m-2 nm-1 the output is in mol m-2 s-1 or W m-2.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_irrad</span>(sun.spct, <span class="kw">UV</span>()) <span class="co"># W m-2</span></code></pre></div>
<pre><code>##  UV.ISO.tr.lo 
##      28.62872 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy irradiance total&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">q_irrad</span>(sun.spct, <span class="kw">UV</span>()) <span class="op">*</span><span class="st"> </span><span class="fl">1e6</span> <span class="co"># umol s-1 m-2</span></code></pre></div>
<pre><code>##  UV.ISO.tr.lo 
##      86.49506 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;photon irradiance total&quot;</code></pre>
<p>Irradiances for different wavebands can be grouped into a list of any length. If the list has named members, then these names are used instead of the default ones.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_irrad</span>(sun.spct, <span class="kw">list</span>(<span class="kw">Blue</span>(), <span class="kw">VIS</span>()))</code></pre></div>
<pre><code>##  Blue.ISO   VIS.ISO 
##  37.55207 231.86345 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy irradiance total&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_irrad</span>(sun.spct, <span class="kw">list</span>(<span class="dt">B =</span> <span class="kw">Blue</span>(), <span class="kw">VIS</span>()))</code></pre></div>
<pre><code>##  Blue.ISO   VIS.ISO 
##  37.55207 231.86345 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy irradiance total&quot;</code></pre>
<p>A few functions for generating coherent lists of wavebands are also defined (Table bellow).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_irrad</span>(sun.spct, <span class="kw">VIS_bands</span>())</code></pre></div>
<pre><code>##  Purple.ISO    Blue.ISO   Green.ISO  Yellow.ISO  Orange.ISO     Red.ISO 
##    47.75529    37.55207    49.26860    13.67971    12.00432    79.38159 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy irradiance total&quot;</code></pre>
</div>
<div id="photon-ratios" class="section level2">
<h2>Photon ratios</h2>
<p>Photon ratios can be calculated from any pair of waveband objects. This a convenient and very flexible way of doing this type of calculations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">q_ratio</span>(sun.spct, <span class="kw">Blue</span>(), <span class="kw">VIS</span>())</code></pre></div>
<pre><code>##  Blue.ISO: VIS.ISO(q:q) 
##               0.1371157 
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;q:q ratio&quot;</code></pre>
</div>
<div id="spectral-weighting-functions-swfs" class="section level2">
<h2>Spectral weighting functions (SWFs)</h2>
<p>Currently functions for constructing <code>waveband</code> objects describing several BSWFs are implemented (see Table below). These functions take three arguments in most cases as they have been used and continue to be used inconsistently in the scientific literature. By supplying these arguments different variations of the BSWFs can be obtained. The defaults used are those values which we consider best, usually the most frequently used ones, except in cases when we consider the use of those values problematic for the reliability of the calculations.</p>
<div id="waveband-constructors-for-bswfs" class="section level3">
<h3>Waveband constructors for BSWFs</h3>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>ultraviolet</strong></td>
<td></td>
</tr>
<tr class="even">
<td>GEN_G()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="odd">
<td>GEN_T()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="even">
<td>GEN_M()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="odd">
<td>PG()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="even">
<td>CIE()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="odd">
<td>ICNIRP()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="even">
<td>DNA_N()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="odd">
<td>DNA_GM()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="even">
<td>DNA_P()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="odd">
<td>FLAV()</td>
<td>norm, w.low, w.high</td>
</tr>
<tr class="even">
<td>CH4()</td>
<td>norm, w.low, w.high</td>
</tr>
</tbody>
</table>
</div>
<div id="effective-irradiances-and-exposures" class="section level3">
<h3>Effective irradiances and exposures</h3>
<p>Both waveband definitions based on a wavelength range and SWFs are stored in <code>waveband</code> objects, that can be created with function .</p>
<p>The same functions used in the examples above for calculation of unweighted irradiances are used to calculate effective irradiances and exposures (sometimes called “doses”).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_irrad</span>(sun.spct, <span class="kw">CIE</span>())</code></pre></div>
<pre><code>##  CIE98.298.tr.lo 
##       0.08181583 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy irradiance total&quot;</code></pre>
</div>
<div id="bswfs-function-definitions" class="section level3">
<h3>BSWFs function definitions</h3>
<table>
<thead>
<tr class="header">
<th>constructor</th>
<th>parameters</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GEN_G_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>GEN_T_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>GEN_M_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>PG_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>CIE_e_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>CIE_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>ICNIRP_e_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>DNA_N_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>DNA_GM_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>DNA_P_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>FLAV_q_fun()</td>
<td>w.length</td>
</tr>
<tr class="even">
<td>CH4_e_fun()</td>
<td>w.length</td>
</tr>
<tr class="odd">
<td>CH4_q_fun()</td>
<td>w.length</td>
</tr>
</tbody>
</table>
<p>The functions available for calculating action spectra take as argument a vector of wavelengths, and return a vector of effectiveness (either quantum/photon or energy based) depending on how the original source describes them. These functions are listed in the Table above, and an example of their use follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># at 1 nm intervals</span>
wavelengths1 &lt;-<span class="st"> </span><span class="dv">285</span><span class="op">:</span><span class="dv">400</span>
action.spectrum1 &lt;-<span class="st"> </span><span class="kw">CIE_e_fun</span>(wavelengths1)</code></pre></div>
<p>All functions accept a wavelengths vector with variable and arbitrary step sizes, with the condition that the wavelengths are sorted in strictly increasing order.</p>
<p>These functions are used internally by the package, but are also used for the calculation of effective spectral irradiances by multiplication of a <code>source_spct</code> object by a <code>waveband</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sun.spct <span class="op">*</span><span class="st"> </span><span class="kw">CIE</span>()</code></pre></div>
<pre><code>## Object: source_spct [122 x 2]
## Wavelength range 280 to 400 nm, step 0.9230769 to 1 nm 
## Time unit 1s
## Data weighted using 'CIE98.298' BSWF
## 
## # A tibble: 122 x 2
##    w.length s.e.irrad
##       &lt;dbl&gt;     &lt;dbl&gt;
##  1     280.        0.
##  2     281.        0.
##  3     282.        0.
##  4     283.        0.
##  5     284.        0.
##  6     285.        0.
##  7     286.        0.
##  8     286.        0.
##  9     287.        0.
## 10     288.        0.
## # ... with 112 more rows</code></pre>
</div>
</div>
<div id="luminous-flux" class="section level2">
<h2>Luminous flux</h2>
<p>The luminous flux per unit area in lux can be calculated as follows using the original luminous efficiency function for the human eye used when the <em>lumen</em> definition was standardized. As we start with spectral irradiance we obtain luminous flux per unit area expressed in lux. The spectra luminous efficiency function data are included in package ‘photobiology’.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_response</span>(sun.spct <span class="op">*</span><span class="st"> </span>CIE1924_lef.spct) <span class="op">*</span><span class="st"> </span>photopic_sensitivity</code></pre></div>
<pre><code>##    Total 
## 49579.93 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy response total&quot;</code></pre>
<p>The luminous flux per unit area in lux can be calculated as follows using the latest luminous efficiency function for the human eye.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_response</span>(sun.spct <span class="op">*</span><span class="st"> </span>CIE2008_lef2deg.spct) <span class="op">*</span><span class="st"> </span>photopic_sensitivity</code></pre></div>
<pre><code>##    Total 
## 53057.78 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy response total&quot;</code></pre>
<p>As the luminous efficiency functions vary slightly in the wavelength at which the maximum is located, and the wavelength used for the sensitivity constant is fixed by the definition of the Lumen, a small correction is need for exact results.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_response</span>(sun.spct <span class="op">*</span><span class="st"> </span>CIE2008_lef2deg.spct) <span class="op">*</span><span class="st"> </span>photopic_sensitivity <span class="op">*</span>
<span class="st">                       </span><span class="kw">interpolate_spct</span>(CIE2008_lef2deg.spct, <span class="dv">555</span>)<span class="op">$</span>s.e.response</code></pre></div>
<pre><code>##    Total 
## 53910.01 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy response total&quot;</code></pre>
<p>An equivalent quantity can be calculated for scotopic vision, using the corresponding function and constant.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">e_response</span>(sun.spct <span class="op">*</span><span class="st"> </span><span class="fl">1e-6</span> <span class="op">*</span><span class="st"> </span>CIE1951_scotopic_lef.spct) <span class="op">*</span><span class="st"> </span>scotopic_sensitivity</code></pre></div>
<pre><code>##     Total 
## 0.1186256 
## attr(,&quot;time.unit&quot;)
## [1] &quot;second&quot;
## attr(,&quot;radiation.unit&quot;)
## [1] &quot;energy response total&quot;</code></pre>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
